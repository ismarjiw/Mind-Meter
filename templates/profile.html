{% extends 'logout.html' %}
{% block title %} Profile Page {% endblock %}

{% block head %}
{# ChartJS #}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.1/dist/chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/luxon@2.0.2/build/global/luxon.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.1.0/dist/chartjs-adapter-luxon.min.js"></script>
{% endblock %}

{% block body %}

<section id="timer">

    <label for="timer">Select how long you would like to meditate in minutes:</label>
    <button id='five' type="button" value=5 class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">5</button>
    <button id='ten' type="button" value=10 class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">10</button>

    <div id= "timer-result"> </div>

</section>

<!-- <div style="color:white" id="meditation-data"></div> -->

{% for streak in streak %}
<div id="streak ">{{ streak }}</div>
{% endfor %}

<a href="/profile/{{session['user_id']}}">Click here to write a reflection to add to your meditation journal</a>
<div>
    <a href="/journal">Click here to see all journal entries</a>
</div>


<button onclick="deleteAccount('{{ user.user_id }}')" type="button" class="delete text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">Delete Account</button>    


<script>
    
    function deleteAccount(user_id) {
        fetch(`/delete-account/${user_id}`) 
            .then((response) => {
                window.location = '/';
        });
    };

</script>

<div id="site-content" style="width:600px;height:250px">
    <h2>Bar Chart w/ Time Scale</h2>
    <canvas id="line-time"></canvas>
</div>

<script>
    fetch('/meditations_this_week.json')
.then((response) => response.json())
.then((responseJson) => {
    const data = responseJson.data.map((dailyTotal) => ({
    x: dailyTotal.date,
    y: dailyTotal.length,
    }));

    new Chart(document.querySelector('#line-time'), {
    type: 'bar',
    data: {
        datasets: [
        {
            label: 'Minutes meditated',
            data, // equivalent to data: data
            borderColor: '#5D75BB',
            backgroundColor: '#5D75BB',
        },
        ],
    },
    options: {
        scales: {
        x: {
            type: 'time',
            time: {
            tooltipFormat: 'LLLL dd', // Luxon format string
            unit: 'day',
            },
        },
        },
    },
    });
});
</script>

<!-- youtube sound buttons -->
<div style="display:flex;justify-content:center;align-items:center;">
    <div style="width:400px;height:300px;">
        <div data-video="42M3esYyHdw" data-autoplay="0" data-loop="1" id="youtube-audio1"></div>
        <div data-video="fBVJoIbNjdQ" data-autoplay="0" data-loop="1" id="youtube-audio2"></div>
        <div data-video="LTmXmskEMas" data-autoplay="0" data-loop="1" id="youtube-audio3"></div>
        <div data-video="6cDiJCM-6KA" data-autoplay="0" data-loop="1" id="youtube-audio4"></div>
        <div style="clear:both;margin:10px;text-align:center">
        </div>
    </div>
</div>

<script src="/static/src/profile.js"></script>
{% endblock %}